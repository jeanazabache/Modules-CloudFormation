parameters:
  sonarCloudBranch:
  scannerMode:
  configMode:
  extraProperties:
  sonarCloud:
  organization:
  cliProjectKey:
  cliProjectName:
  firstUploadSonarCloud: false
steps:
  # - bash: |
      # BRANCH_SONARCLOUD=''
      # if [[ "${{parameters.firstUploadSonarCloud}}" == "false" ]]; 
      #   then BRANCH_SONARCLOUD=`echo "sonar.branch.name=${{ parameters.sonarCloudBranch }}"`
      # fi
      # echo "##vso[task.setvariable variable=sonarCloudBranch]$BRANCH_SONARCLOUD"
    # condition: succeeded()
    # displayName: 'Set branch for sonarcloud'

  - task: SonarCloudPrepare@1
    inputs:
      sonarCloud: ${{ parameters.sonarCloud }}
      organization: ${{ parameters.organization }}
      scannerMode: ${{ parameters.scannerMode }}
      configMode: ${{ parameters.configMode }}
      cliProjectKey: ${{ parameters.cliProjectKey }}
      cliProjectName: ${{ parameters.cliProjectName }}
      cliSources: '.'  
      extraProperties: |
        ${{ parameters.extraProperties }}

  # Enviar analizar y publicar sonarcloud
  - template: /sonarcloud/scanners/sonarcloud_analyze_publish.yml@InfraestructuraCorporativa

